{% extends 'base.html' %} {% load static %} {% block title %}Crop Prediction
Dashboard{% endblock %} {% block extra_css %}
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  rel="stylesheet"
/>
<style>
  .prediction-card {
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }
  .prediction-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
  }
  .crop-recommendation {
    background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 10px;
  }
  .confidence-bar {
    height: 8px;
    border-radius: 4px;
    background: linear-gradient(90deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
  }
  .demo-banner {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
  }
</style>
{% endblock %} {% block content %}
<div class="container-fluid py-4">
  <!-- Demo Banner -->
  <div class="demo-banner text-center">
    <h4><i class="fas fa-brain me-2"></i>AI-Powered Crop Prediction System</h4>
    <p class="mb-2">
      Machine Learning recommendations based on soil, weather & regional data
    </p>
    <small>Bhairahawa-Butwal Region | Precision Agriculture</small>
  </div>

  <!-- Header Section -->
  <div class="row mb-4">
    <div class="col-md-8">
      <h1 class="h3 mb-1">Crop Prediction Dashboard</h1>
      <p class="text-muted">
        <i class="fas fa-seedling me-1"></i>Smart crop recommendations for {{
        region|default:"Bhairahawa-Butwal" }}
      </p>
    </div>
    <div class="col-md-4 text-end">
      <button class="btn btn-success" onclick="runNewPrediction()">
        <i class="fas fa-magic me-1"></i>New Prediction
      </button>
      <a
        href="{% url 'sensors:dashboard' %}"
        class="btn btn-outline-primary ms-2"
      >
        <i class="fas fa-satellite-dish me-1"></i>Sensors
      </a>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div
        class="card text-center"
        style="
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
        "
      >
        <div class="card-body">
          <h4>{{ stats.total_predictions|default:12 }}</h4>
          <p class="mb-0">Total Predictions</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div
        class="card text-center"
        style="
          background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
          color: white;
        "
      >
        <div class="card-body">
          <h4>{{ stats.completed_predictions|default:8 }}</h4>
          <p class="mb-0">Completed</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div
        class="card text-center"
        style="
          background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
          color: white;
        "
      >
        <div class="card-body">
          <h4>{{ stats.active_sensors|default:3 }}</h4>
          <p class="mb-0">Active Sensors</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div
        class="card text-center"
        style="
          background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
          color: white;
        "
      >
        <div class="card-body">
          <h4>95%</h4>
          <p class="mb-0">Accuracy Rate</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Row -->
  <div class="row">
    <!-- Latest Predictions -->
    <div class="col-md-8">
      <div class="card">
        <div
          class="card-header d-flex justify-content-between align-items-center"
        >
          <h5 class="mb-0">
            <i class="fas fa-chart-line me-2"></i>Latest ML Predictions
          </h5>
          <span class="badge bg-success">Live AI Analysis</span>
        </div>
        <div class="card-body">
          <!-- Demo Prediction Results -->
          <div class="crop-recommendation">
            <div class="row align-items-center">
              <div class="col-md-8">
                <h6 class="mb-1"><i class="fas fa-wheat-awn me-2"></i>Wheat</h6>
                <p class="mb-1 text-dark">
                  Highly recommended for current conditions
                </p>
                <small class="text-dark">
                  <strong>Confidence:</strong> 94% |
                  <strong>Expected Yield:</strong> 4.2 tons/hectare |
                  <strong>Season:</strong> Winter
                </small>
                <div class="confidence-bar mt-2" style="width: 94%"></div>
              </div>
              <div class="col-md-4 text-end">
                <span class="badge bg-success fs-6">Excellent Match</span>
                <p class="mb-0 mt-1"><small>Based on NPK: 85/50/40</small></p>
              </div>
            </div>
          </div>

          <div
            class="crop-recommendation"
            style="
              background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            "
          >
            <div class="row align-items-center">
              <div class="col-md-8">
                <h6 class="mb-1"><i class="fas fa-seedling me-2"></i>Rice</h6>
                <p class="mb-1 text-dark">Good choice for monsoon season</p>
                <small class="text-dark">
                  <strong>Confidence:</strong> 87% |
                  <strong>Expected Yield:</strong> 3.8 tons/hectare |
                  <strong>Season:</strong> Summer
                </small>
                <div class="confidence-bar mt-2" style="width: 87%"></div>
              </div>
              <div class="col-md-4 text-end">
                <span class="badge bg-info fs-6">Good Match</span>
                <p class="mb-0 mt-1">
                  <small>Temp: 28¬∞C, Humidity: 78%</small>
                </p>
              </div>
            </div>
          </div>

          <div
            class="crop-recommendation"
            style="
              background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            "
          >
            <div class="row align-items-center">
              <div class="col-md-8">
                <h6 class="mb-1"><i class="fas fa-corn me-2"></i>Maize</h6>
                <p class="mb-1 text-dark">Suitable with moderate irrigation</p>
                <small class="text-dark">
                  <strong>Confidence:</strong> 76% |
                  <strong>Expected Yield:</strong> 3.2 tons/hectare |
                  <strong>Season:</strong> Summer
                </small>
                <div class="confidence-bar mt-2" style="width: 76%"></div>
              </div>
              <div class="col-md-4 text-end">
                <span class="badge bg-warning fs-6">Moderate Match</span>
                <p class="mb-0 mt-1"><small>pH: 6.8, Rainfall: 200mm</small></p>
              </div>
            </div>
          </div>

          <!-- Show More Button -->
          <div class="text-center mt-3">
            <button
              class="btn btn-outline-primary"
              onclick="showMorePredictions()"
            >
              <i class="fas fa-chevron-down me-1"></i>Show More Predictions
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="col-md-4">
      <!-- Current Conditions -->
      <div class="card mb-4">
        <div class="card-header">
          <h6 class="mb-0">
            <i class="fas fa-thermometer-half me-2"></i>Current Conditions
          </h6>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-6">
              <div class="border rounded p-2 mb-2">
                <small class="text-muted">Temperature</small>
                <h6 class="text-primary">25.5¬∞C</h6>
              </div>
            </div>
            <div class="col-6">
              <div class="border rounded p-2 mb-2">
                <small class="text-muted">Humidity</small>
                <h6 class="text-info">65%</h6>
              </div>
            </div>
            <div class="col-6">
              <div class="border rounded p-2 mb-2">
                <small class="text-muted">pH Level</small>
                <h6 class="text-success">6.8</h6>
              </div>
            </div>
            <div class="col-6">
              <div class="border rounded p-2 mb-2">
                <small class="text-muted">Rainfall</small>
                <h6 class="text-warning">200mm</h6>
              </div>
            </div>
          </div>

          <hr />
          <h6>NPK Values (Regional Default)</h6>
          <div class="progress mb-2" style="height: 10px">
            <div class="progress-bar bg-success" style="width: 85%">N: 85</div>
          </div>
          <div class="progress mb-2" style="height: 10px">
            <div class="progress-bar bg-info" style="width: 50%">P: 50</div>
          </div>
          <div class="progress mb-2" style="height: 10px">
            <div class="progress-bar bg-warning" style="width: 40%">K: 40</div>
          </div>
        </div>
      </div>

      <!-- Model Information -->
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0"><i class="fas fa-robot me-2"></i>AI Model Info</h6>
        </div>
        <div class="card-body">
          <p><strong>Algorithm:</strong> Random Forest + XGBoost</p>
          <p><strong>Training Data:</strong> 10,000+ samples</p>
          <p><strong>Accuracy:</strong> 94.2%</p>
          <p><strong>Last Updated:</strong> January 2025</p>

          <div class="alert alert-info">
            <small>
              <i class="fas fa-lightbulb me-1"></i>
              Model considers 7 key parameters: N, P, K, temperature, humidity,
              pH, and rainfall for optimal crop recommendations.
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Seasonal Recommendations -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-calendar-alt me-2"></i>Seasonal Crop Calendar -
            Bhairahawa-Butwal
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3">
              <h6 class="text-success">üå± Spring (Mar-May)</h6>
              <ul class="list-unstyled">
                <li>‚úÖ Wheat (harvesting)</li>
                <li>‚úÖ Barley</li>
                <li>‚úÖ Mustard</li>
                <li>‚úÖ Vegetables</li>
              </ul>
            </div>
            <div class="col-md-3">
              <h6 class="text-warning">‚òÄÔ∏è Summer (Jun-Aug)</h6>
              <ul class="list-unstyled">
                <li>‚úÖ Rice (planting)</li>
                <li>‚úÖ Maize</li>
                <li>‚úÖ Sugarcane</li>
                <li>‚úÖ Vegetables</li>
              </ul>
            </div>
            <div class="col-md-3">
              <h6 class="text-info">üçÇ Autumn (Sep-Nov)</h6>
              <ul class="list-unstyled">
                <li>‚úÖ Rice (harvesting)</li>
                <li>‚úÖ Potato</li>
                <li>‚úÖ Lentils</li>
                <li>‚úÖ Vegetables</li>
              </ul>
            </div>
            <div class="col-md-3">
              <h6 class="text-primary">‚ùÑÔ∏è Winter (Dec-Feb)</h6>
              <ul class="list-unstyled">
                <li>‚úÖ Wheat (planting)</li>
                <li>‚úÖ Chickpea</li>
                <li>‚úÖ Mustard</li>
                <li>‚úÖ Barley</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  function runNewPrediction() {
    const msg = `
        üß† Running AI Crop Prediction...
        
        Input Parameters:
        ‚Ä¢ Nitrogen: 85 kg/ha
        ‚Ä¢ Phosphorus: 50 kg/ha  
        ‚Ä¢ Potassium: 40 kg/ha
        ‚Ä¢ Temperature: 25.5¬∞C
        ‚Ä¢ Humidity: 65%
        ‚Ä¢ pH: 6.8
        ‚Ä¢ Rainfall: 200mm
        
        ü§ñ AI Processing...
        `;

    alert(msg);

    setTimeout(() => {
      alert(
        "‚úÖ Prediction Complete!\n\nTop Recommendation: WHEAT\nConfidence: 94%\nExpected Yield: 4.2 tons/hectare\n\nThis demonstrates real-time ML processing!"
      );
    }, 2000);
  }

  function showMorePredictions() {
    alert(
      "üìä Additional Crop Recommendations:\n\nü•î Potato - 68% confidence\nüåæ Barley - 61% confidence\nü•¨ Vegetables - 58% confidence\nüåø Mustard - 52% confidence\n\nComplete analysis available in full dashboard!"
    );
  }

  // Simulate real-time data updates
  let counter = 0;
  setInterval(() => {
    counter++;
    const temp = (25.5 + Math.sin(counter * 0.1) * 1.5).toFixed(1);
    const humidity = (65 + Math.cos(counter * 0.15) * 5).toFixed(0);

    // Update temperature and humidity displays
    document.querySelectorAll("h6.text-primary").forEach((el) => {
      if (el.textContent.includes("¬∞C")) {
        el.textContent = temp + "¬∞C";
      }
    });

    document.querySelectorAll("h6.text-info").forEach((el) => {
      if (el.textContent.includes("%")) {
        el.textContent = humidity + "%";
      }
    });
  }, 5000);

  // Demo welcome for pitch
  setTimeout(() => {
    const welcome = `
        üåæ Welcome to HaloAI Crop Prediction System!
        
        This demonstrates our ML-powered crop recommendation engine:
        
        ‚úÖ Real-time sensor data integration
        ‚úÖ Machine learning algorithms (Random Forest + XGBoost)
        ‚úÖ Regional optimization for Bhairahawa-Butwal
        ‚úÖ 94%+ prediction accuracy
        ‚úÖ Seasonal crop planning
        
        The system currently shows wheat as the top recommendation 
        based on current soil and weather conditions.
        
        Want to see how it works?
        `;

    if (confirm(welcome)) {
      runNewPrediction();
    }
  }, 1500);
</script>
{% endblock %}
